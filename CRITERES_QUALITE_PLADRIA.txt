===============================================================================
                    CRITÃˆRES DE CONTRÃ”LE QUALITÃ‰ - PLADRIA
                           Module 5 - ContrÃ´le QualitÃ©
===============================================================================
                                CRITÃˆRE 1
                           Ã‰CART PLAN ADRESSAGE
===============================================================================


ğŸ¯ OBJECTIF :
   DÃ©tecte les incohÃ©rences entre le fichier RÃ©sultats QGis et le fichier 
   Suivi Commune en comparant le nombre d'occurrences des motifs du Plan Adressage.

ğŸ“Š SOURCES DE DONNÃ‰ES :
   â€¢ Fichier QGis : Colonne J (Import Fantome)
   â€¢ Fichier Suivi Commune : Page 2, Colonne I (Motif)

ğŸ” MOTIFS ANALYSÃ‰S :
   1. AD RAS
   2. OK
   3. NOK
   4. UPR RAS
   5. UPR OK
   6. UPR NOK
   7. HORS COMMUNE

âš™ï¸ LOGIQUE DE DÃ‰TECTION :
   â€¢ Compare le nombre d'occurrences de chaque motif dans les deux fichiers
   â€¢ Calcule la diffÃ©rence : QGis - Suivi
   â€¢ Signale un Ã©cart si la diffÃ©rence â‰  0

ğŸ“ˆ RÃ‰SULTAT :
   â€¢ Comptage par motif (Suivi vs Fichier QGis)
   â€¢ Liste des Ã©carts dÃ©tectÃ©s avec diffÃ©rences
   â€¢ Remplissage automatique de la section "Ã‰cart Plan Adressage" dans le rapport Excel

===============================================================================
                                CRITÃˆRE 2
                        OUBLI TICKET UPR ET 501/511
===============================================================================

ğŸ¯ OBJECTIF :
   VÃ©rifie si les collaborateurs ont dÃ©posÃ© les tickets UPR et 501/511 requis
   selon les motifs utilisÃ©s dans les diffÃ©rentes pages du fichier suivi commune.

ğŸ“Š SOURCES DE DONNÃ‰ES :
   â€¢ Page 1 : Colonne E (Motif Voie) - CrÃ©ation/Modification Voie
   â€¢ Page 2 : Colonne I (Motif) - UPR OK, OK
   â€¢ Page 3 : Colonne Q (ID Ticket 501/511), Colonne T (ID Ticket UPR)

ğŸ” RÃˆGLES DE VALIDATION :

   ğŸ“Œ TICKET UPR :
   â€¢ SI motif "UPR OK" trouvÃ© en page 2, colonne I
   â€¢ ALORS ticket UPR obligatoire en page 3, colonne T
   â€¢ STATUT : OK si ticket prÃ©sent, NOK si absent, N/A si pas requis

   ğŸ“Œ TICKET 501/511 :
   â€¢ SI motif "CrÃ©ation Voie" OU "Modification Voie" en page 1, colonne E
   â€¢ OU SI motif "OK" en page 2, colonne I
   â€¢ ALORS ticket 501/511 obligatoire en page 3, colonne Q
   â€¢ STATUT : OK si ticket prÃ©sent, NOK si absent, N/A si pas requis

âš™ï¸ LOGIQUE DE DÃ‰TECTION :
   â€¢ Lecture des 3 pages du fichier suivi commune
   â€¢ DÃ©tection des motifs dÃ©clencheurs dans pages 1 et 2
   â€¢ VÃ©rification de la prÃ©sence des tickets en page 3
   â€¢ GÃ©nÃ©ration d'erreurs pour les tickets manquants

ğŸ“ˆ RÃ‰SULTAT :
   â€¢ Statut Ticket UPR : OK/NOK/N/A
   â€¢ Statut Ticket 501/511 : OK/NOK/N/A
   â€¢ Remplissage automatique de la section "Tickets" dans le rapport Excel

===============================================================================
                                CRITÃˆRE 3
                           CONTRÃ”LE IMB DOUBLONS
===============================================================================

ğŸ¯ OBJECTIF :
   DÃ©tecte les IMB  suspects dans le fichier RÃ©sultats QGis en identifiant
   les codes IMB identiques ayant le mÃªme motif de traitement, ce qui indique
   une anomalie de saisie.


ğŸ“Š SOURCES DE DONNÃ‰ES :
   â€¢ Fichier : RÃ©sultats QGis (fichier Excel importÃ©)
   â€¢ Colonne A : Num Dossier Site (codes IMB)
   â€¢ Colonne B : Numero Voie Site
   â€¢ Colonne C : Repondant Voie Site
   â€¢ Colonne D : Libelle Voie Site
   â€¢ Colonne J : Import Fantome (motifs de traitement)
   â€¢ Colonne U : Adresse BAN

ğŸ” LOGIQUE DE DÃ‰TECTION :
  ğŸ“Œ .Identifier les codes IMB dupliquÃ©s (colonne A)
      . Pour chaque groupe de doublons :
      	â€¢ VÃ©rifier si les adresses BAN (colonne U) sont diffÃ©rentes
     		â€¢ VÃ©rifier si le motif (colonne J) est identique
   	. Si adresses diffÃ©rentes + motif identique â†’ Doublon suspect
  ğŸ“Œ Construire l'adresse optimum selon les rÃ¨gles :
      â€¢ Si C est vide : [B] [D] uniquement (ex: "2 route de toulouse")
      â€¢ Si B ou C est vide : [D] uniquement (ex: "route de toulouse")
      â€¢ Cas normal : [B] [C] [D] (ex: "2 B route de toulouse")
  ğŸ“Œ  DÃ©tecter les erreurs de motif "OK" :
      â€¢ Si motif = "OK" ET adresse optimum = adresse BAN â†’ Erreur de saisie
      â€¢ Applicable Ã  tous les IMB (doublons ou non)

âš™ï¸ DONNÃ‰ES EXTRAITES POUR LE RAPPORT :
   â€¢ Colonne A â†’ Page 3, Colonne A (Num Dossier Site)
   â€¢ Colonnes B+C+D â†’ Page 3, Colonne B (Adresse Optimum concatÃ©nÃ©e)
   â€¢ Colonne J â†’ Page 3, Colonne D (Motif Initial)
   â€¢ Colonne U â†’ Page 3, Colonne U (Adresse BAN)

ğŸ“ˆ RÃ‰SULTAT :
   â€¢ Nombre total de doublons IMB dÃ©tectÃ©s
   â€¢ Liste des doublons suspects avec dÃ©tails
   â€¢ DÃ©tection des erreurs de motif "OK" avec adresses identiques
   â€¢ DÃ©tection des motifs "AD Ã€ ANALYSER" avec IMB prÃ©sent
   â€¢ Remplissage automatique de la page 3 du rapport Excel
   â€¢ Identification complÃ¨te des anomalies de saisie et Ã©lÃ©ments Ã  analyser

===============================================================================
                                CRITÃˆRE 4
                        DÃ‰TECTION "AD Ã€ ANALYSER"
===============================================================================

ğŸ¯ OBJECTIF :
   DÃ©tecte les entrÃ©es avec motif "ad Ã  analyser" qui nÃ©cessitent une analyse
   approfondie, mais seulement lorsqu'il y a effectivement un IMB Ã  analyser
   dans la colonne A.

ğŸ“Š SOURCES DE DONNÃ‰ES :
   â€¢ Fichier : RÃ©sultats QGis (fichier Excel importÃ©)
   â€¢ Colonne A : Num Dossier Site (codes IMB) - OBLIGATOIRE
   â€¢ Colonne B : Numero Voie Site
   â€¢ Colonne C : Repondant Voie Site
   â€¢ Colonne D : Libelle Voie Site
   â€¢ Colonne J : Import Fantome (motifs de traitement)
   â€¢ Colonne U : Adresse BAN

ğŸ” LOGIQUE DE DÃ‰TECTION :
   1. Identifier les lignes avec motif = "ad Ã  analyser" (colonne J)
   2. VÃ©rifier qu'il y a un code IMB prÃ©sent dans la colonne A
   3. Si motif = "ad Ã  analyser" ET IMB prÃ©sent â†’ EntrÃ©e Ã  analyser
   4. Construire l'adresse optimum selon les rÃ¨gles du CRITÃˆRE 3
   5. Exclure les lignes sans IMB (colonne A vide)

âš™ï¸ DONNÃ‰ES EXTRAITES POUR LE RAPPORT :
   â€¢ Colonne A â†’ Page 3, Colonne A (Num Dossier Site)
   â€¢ Colonnes B+C+D â†’ Page 3, Colonne B (Adresse Optimum concatÃ©nÃ©e)
   â€¢ Colonne J â†’ Page 3, Colonne D (Motif Initial = "ad Ã  analyser")
   â€¢ Colonne U â†’ Page 3, Colonne U (Adresse BAN)

ğŸ“ˆ RÃ‰SULTAT :
   â€¢ Nombre total d'entrÃ©es "ad Ã  analyser" avec IMB
   â€¢ Liste des adresses nÃ©cessitant une analyse
   â€¢ Remplissage automatique de la page 3 du rapport Excel
   â€¢ Facilitation du suivi des analyses requises

===============================================================================
                                CRITÃˆRE 5
                            MOTIF INCORRECT
===============================================================================

ğŸ¯ OBJECTIF :
   DÃ©tecte les motifs incorrects saisis par les collaborateurs dans le fichier
   RÃ©sultats QGis lorsqu'ils utilisent des motifs non autorisÃ©s dans la colonne J.

ğŸ“Š SOURCES DE DONNÃ‰ES :
   â€¢ Fichier : RÃ©sultats QGis (fichier Excel importÃ©)
   â€¢ Colonne A : Num Dossier Site (codes IMB)
   â€¢ Colonne J : Import Fantome (motifs Ã  vÃ©rifier)

ğŸ” MOTIFS AUTORISÃ‰S :
   1. AD RAS
   2. OK
   3. NOK
   4. UPR RAS
   5. UPR OK
   6. UPR NOK
   7. HORS COMMUNE

ğŸ” LOGIQUE DE DÃ‰TECTION :
   1. Lire tous les motifs de la colonne J (Import Fantome) du fichier QGis
   2. Comparer chaque motif avec la liste des motifs autorisÃ©s
   3. Si motif â‰  motifs autorisÃ©s â†’ Motif incorrect dÃ©tectÃ©
   4. Collecter les informations pour le rapport

âš™ï¸ DONNÃ‰ES EXTRAITES POUR LE RAPPORT :
   â€¢ Colonne A â†’ Page 3, Colonne A (Num Dossier Site)
   â€¢ Colonne J â†’ Page 3, Colonne D (Motif Incorrect)

ğŸ“ˆ RÃ‰SULTAT :
   â€¢ Nombre total de motifs incorrects dÃ©tectÃ©s
   â€¢ Liste des IMB avec motifs non autorisÃ©s
   â€¢ Remplissage automatique de la page 3 du rapport Excel
   â€¢ Facilitation de la correction des erreurs de saisie

