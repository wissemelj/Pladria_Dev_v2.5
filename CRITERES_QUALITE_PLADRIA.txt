===============================================================================
                    CRITÈRES DE CONTRÔLE QUALITÉ - PLADRIA
                           Module 5 - Contrôle Qualité
===============================================================================
                                CRITÈRE 1
                           ÉCART PLAN ADRESSAGE
===============================================================================


🎯 OBJECTIF :
   Détecte les incohérences entre le fichier Résultats QGis et le fichier 
   Suivi Commune en comparant le nombre d'occurrences des motifs du Plan Adressage.

📊 SOURCES DE DONNÉES :
   • Fichier QGis : Colonne J (Import Fantome)
   • Fichier Suivi Commune : Page 2, Colonne I (Motif)

🔍 MOTIFS ANALYSÉS :
   1. AD RAS
   2. OK
   3. NOK
   4. UPR RAS
   5. UPR OK
   6. UPR NOK
   7. HORS COMMUNE

⚙️ LOGIQUE DE DÉTECTION :
   • Compare le nombre d'occurrences de chaque motif dans les deux fichiers
   • Calcule la différence : QGis - Suivi
   • Signale un écart si la différence ≠ 0

📈 RÉSULTAT :
   • Comptage par motif (Suivi vs Fichier QGis)
   • Liste des écarts détectés avec différences
   • Remplissage automatique de la section "Écart Plan Adressage" dans le rapport Excel

===============================================================================
                                CRITÈRE 2
                        OUBLI TICKET UPR ET 501/511
===============================================================================

🎯 OBJECTIF :
   Vérifie si les collaborateurs ont déposé les tickets UPR et 501/511 requis
   selon les motifs utilisés dans les différentes pages du fichier suivi commune.

📊 SOURCES DE DONNÉES :
   • Page 1 : Colonne E (Motif Voie) - Création/Modification Voie
   • Page 2 : Colonne I (Motif) - UPR OK, OK
   • Page 3 : Colonne Q (ID Ticket 501/511), Colonne T (ID Ticket UPR)

🔍 RÈGLES DE VALIDATION :

   📌 TICKET UPR :
   • SI motif "UPR OK" trouvé en page 2, colonne I
   • ALORS ticket UPR obligatoire en page 3, colonne T
   • STATUT : OK si ticket présent, NOK si absent, N/A si pas requis

   📌 TICKET 501/511 :
   • SI motif "Création Voie" OU "Modification Voie" en page 1, colonne E
   • OU SI motif "OK" en page 2, colonne I
   • ALORS ticket 501/511 obligatoire en page 3, colonne Q
   • STATUT : OK si ticket présent, NOK si absent, N/A si pas requis

⚙️ LOGIQUE DE DÉTECTION :
   • Lecture des 3 pages du fichier suivi commune
   • Détection des motifs déclencheurs dans pages 1 et 2
   • Vérification de la présence des tickets en page 3
   • Génération d'erreurs pour les tickets manquants

📈 RÉSULTAT :
   • Statut Ticket UPR : OK/NOK/N/A
   • Statut Ticket 501/511 : OK/NOK/N/A
   • Remplissage automatique de la section "Tickets" dans le rapport Excel

===============================================================================
                                CRITÈRE 3
                           CONTRÔLE IMB DOUBLONS
===============================================================================

🎯 OBJECTIF :
   Détecte les IMB  suspects dans le fichier Résultats QGis en identifiant
   les codes IMB identiques ayant le même motif de traitement, ce qui indique
   une anomalie de saisie.


📊 SOURCES DE DONNÉES :
   • Fichier : Résultats QGis (fichier Excel importé)
   • Colonne A : Num Dossier Site (codes IMB)
   • Colonne B : Numero Voie Site
   • Colonne C : Repondant Voie Site
   • Colonne D : Libelle Voie Site
   • Colonne J : Import Fantome (motifs de traitement)
   • Colonne U : Adresse BAN

🔍 LOGIQUE DE DÉTECTION :
  📌 .Identifier les codes IMB dupliqués (colonne A)
      . Pour chaque groupe de doublons :
      	• Vérifier si les adresses BAN (colonne U) sont différentes
     		• Vérifier si le motif (colonne J) est identique
   	. Si adresses différentes + motif identique → Doublon suspect
  📌 Construire l'adresse optimum selon les règles :
      • Si C est vide : [B] [D] uniquement (ex: "2 route de toulouse")
      • Si B ou C est vide : [D] uniquement (ex: "route de toulouse")
      • Cas normal : [B] [C] [D] (ex: "2 B route de toulouse")
  📌  Détecter les erreurs de motif "OK" :
      • Si motif = "OK" ET adresse optimum = adresse BAN → Erreur de saisie
      • Applicable à tous les IMB (doublons ou non)

⚙️ DONNÉES EXTRAITES POUR LE RAPPORT :
   • Colonne A → Page 3, Colonne A (Num Dossier Site)
   • Colonnes B+C+D → Page 3, Colonne B (Adresse Optimum concaténée)
   • Colonne J → Page 3, Colonne D (Motif Initial)
   • Colonne U → Page 3, Colonne U (Adresse BAN)

📈 RÉSULTAT :
   • Nombre total de doublons IMB détectés
   • Liste des doublons suspects avec détails
   • Détection des erreurs de motif "OK" avec adresses identiques
   • Détection des motifs "AD À ANALYSER" avec IMB présent
   • Remplissage automatique de la page 3 du rapport Excel
   • Identification complète des anomalies de saisie et éléments à analyser

===============================================================================
                                CRITÈRE 4
                        DÉTECTION "AD À ANALYSER"
===============================================================================

🎯 OBJECTIF :
   Détecte les entrées avec motif "ad à analyser" qui nécessitent une analyse
   approfondie, mais seulement lorsqu'il y a effectivement un IMB à analyser
   dans la colonne A.

📊 SOURCES DE DONNÉES :
   • Fichier : Résultats QGis (fichier Excel importé)
   • Colonne A : Num Dossier Site (codes IMB) - OBLIGATOIRE
   • Colonne B : Numero Voie Site
   • Colonne C : Repondant Voie Site
   • Colonne D : Libelle Voie Site
   • Colonne J : Import Fantome (motifs de traitement)
   • Colonne U : Adresse BAN

🔍 LOGIQUE DE DÉTECTION :
   1. Identifier les lignes avec motif = "ad à analyser" (colonne J)
   2. Vérifier qu'il y a un code IMB présent dans la colonne A
   3. Si motif = "ad à analyser" ET IMB présent → Entrée à analyser
   4. Construire l'adresse optimum selon les règles du CRITÈRE 3
   5. Exclure les lignes sans IMB (colonne A vide)

⚙️ DONNÉES EXTRAITES POUR LE RAPPORT :
   • Colonne A → Page 3, Colonne A (Num Dossier Site)
   • Colonnes B+C+D → Page 3, Colonne B (Adresse Optimum concaténée)
   • Colonne J → Page 3, Colonne D (Motif Initial = "ad à analyser")
   • Colonne U → Page 3, Colonne U (Adresse BAN)

📈 RÉSULTAT :
   • Nombre total d'entrées "ad à analyser" avec IMB
   • Liste des adresses nécessitant une analyse
   • Remplissage automatique de la page 3 du rapport Excel
   • Facilitation du suivi des analyses requises

===============================================================================
                                CRITÈRE 5
                            MOTIF INCORRECT
===============================================================================

🎯 OBJECTIF :
   Détecte les motifs incorrects saisis par les collaborateurs dans le fichier
   Résultats QGis lorsqu'ils utilisent des motifs non autorisés dans la colonne J.

📊 SOURCES DE DONNÉES :
   • Fichier : Résultats QGis (fichier Excel importé)
   • Colonne A : Num Dossier Site (codes IMB)
   • Colonne J : Import Fantome (motifs à vérifier)

🔍 MOTIFS AUTORISÉS :
   1. AD RAS
   2. OK
   3. NOK
   4. UPR RAS
   5. UPR OK
   6. UPR NOK
   7. HORS COMMUNE

🔍 LOGIQUE DE DÉTECTION :
   1. Lire tous les motifs de la colonne J (Import Fantome) du fichier QGis
   2. Comparer chaque motif avec la liste des motifs autorisés
   3. Si motif ≠ motifs autorisés → Motif incorrect détecté
   4. Collecter les informations pour le rapport

⚙️ DONNÉES EXTRAITES POUR LE RAPPORT :
   • Colonne A → Page 3, Colonne A (Num Dossier Site)
   • Colonne J → Page 3, Colonne D (Motif Incorrect)

📈 RÉSULTAT :
   • Nombre total de motifs incorrects détectés
   • Liste des IMB avec motifs non autorisés
   • Remplissage automatique de la page 3 du rapport Excel
   • Facilitation de la correction des erreurs de saisie

